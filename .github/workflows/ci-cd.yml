name: Frontend CI/CD

# ============================================
# Workflow nÃ y cháº¡y trÃªn GitHub's servers (runners)
# GitHub tá»± Ä‘á»™ng cung cáº¥p mÃ¡y áº£o Ubuntu Ä‘á»ƒ build Docker
# ============================================

on:
  push:
    branches:
      - main
      - staging
  pull_request:
    branches:
      - main
      - staging

env:
  DOCKER_HUB_USER: quy123zz
  DOCKER_HUB_REPO: ebay_ecom

jobs:
  build-and-push:
    name: Build and Push Docker Image
    # GitHub cung cáº¥p mÃ¡y áº£o Ubuntu miá»…n phÃ­ Ä‘á»ƒ cháº¡y workflow
    runs-on: ubuntu-latest
    # Sá»­ dá»¥ng Environment Secrets/Variables tá»« environment "staging"
    environment: staging
    
    steps:
      # BÆ°á»›c 1: Láº¥y code tá»« repository vá» mÃ¡y áº£o cá»§a GitHub
      - name: Checkout code
        uses: actions/checkout@v4

      # BÆ°á»›c 2: Táº¡o file .env.production tá»« GitHub Variables
      # File nÃ y sáº½ Ä‘Æ°á»£c Dockerfile sá»­ dá»¥ng Ä‘á»ƒ build Next.js vá»›i Ä‘Ãºng config
      # Chá»‰ NEXT_PUBLIC_* dÃ¹ng vars (Variables), cÃ¡c trÆ°á»ng khÃ¡c dÃ¹ng secrets
      - name: Create .env.production from Variables
        env:
          VAR_BACKEND_URL: ${{ vars.NEXT_PUBLIC_BACKEND_URL }}
          VAR_PRIMARY_COLOR: ${{ vars.NEXT_PUBLIC_PRIMARY_COLOR }}
          VAR_THEME_MODE: ${{ vars.NEXT_PUBLIC_THEME_MODE }}
        run: |
          mkdir -p environment/env/prod
          
          # Debug: Kiá»ƒm tra environment vÃ  variables
          echo "ğŸ” Debugging environment variables..."
          echo "Environment: staging"
          echo "Checking variables..."
          echo "VAR_BACKEND_URL length: ${#VAR_BACKEND_URL}"
          echo "VAR_PRIMARY_COLOR length: ${#VAR_PRIMARY_COLOR}"
          echo "VAR_THEME_MODE length: ${#VAR_THEME_MODE}"
          
          # Validate required variables
          if [ -z "$VAR_BACKEND_URL" ] || [ "$VAR_BACKEND_URL" = "null" ]; then
            echo "âŒ Error: NEXT_PUBLIC_BACKEND_URL is not set!"
            echo ""
            echo "ğŸ“ CÃ¡ch sá»­a:"
            echo "1. VÃ o GitHub â†’ Settings â†’ Environments â†’ staging"
            echo "2. Click vÃ o tab 'Variables' (khÃ´ng pháº£i Secrets)"
            echo "3. ThÃªm variable: NEXT_PUBLIC_BACKEND_URL = http://localhost:8888"
            exit 1
          fi
          if [ -z "$VAR_PRIMARY_COLOR" ] || [ "$VAR_PRIMARY_COLOR" = "null" ]; then
            echo "âŒ Error: NEXT_PUBLIC_PRIMARY_COLOR is not set!"
            echo "Please add it in GitHub Settings â†’ Environments â†’ staging â†’ Variables"
            exit 1
          fi
          if [ -z "$VAR_THEME_MODE" ] || [ "$VAR_THEME_MODE" = "null" ]; then
            echo "âŒ Error: NEXT_PUBLIC_THEME_MODE is not set!"
            echo "Please add it in GitHub Settings â†’ Environments â†’ staging â†’ Variables"
            exit 1
          fi
          
          # Táº¡o file .env.production
          cat > environment/env/prod/.fe.env << EOF
          NEXT_PUBLIC_BACKEND_URL=${VAR_BACKEND_URL}
          NEXT_PUBLIC_PRIMARY_COLOR=${VAR_PRIMARY_COLOR}
          NEXT_PUBLIC_THEME_MODE=${VAR_THEME_MODE}
          EOF
          
          # XÃ¡c nháº­n Ä‘Ã£ táº¡o file (khÃ´ng hiá»ƒn thá»‹ giÃ¡ trá»‹)
          echo "âœ… Created .env.production file from GitHub Variables"
          echo "âœ… Environment variables loaded:"
          echo "  - NEXT_PUBLIC_BACKEND_URL: [HIDDEN]"
          echo "  - NEXT_PUBLIC_PRIMARY_COLOR: [HIDDEN]"
          echo "  - NEXT_PUBLIC_THEME_MODE: [HIDDEN]"

      # BÆ°á»›c 3: Kiá»ƒm tra Docker Hub Secrets
      - name: Validate Docker Hub Secrets
        run: |
          if [ -z "${{ secrets.DOCKER_HUB_USERNAME }}" ]; then
            echo "âŒ Error: DOCKER_HUB_USERNAME secret is not set!"
            echo "Please add DOCKER_HUB_USERNAME secret in GitHub Settings â†’ Secrets â†’ Actions"
            exit 1
          fi
          if [ -z "${{ secrets.DOCKER_HUB_TOKEN }}" ]; then
            echo "âŒ Error: DOCKER_HUB_TOKEN secret is not set!"
            echo "Please add DOCKER_HUB_TOKEN secret in GitHub Settings â†’ Secrets â†’ Actions"
            echo "Create token at: https://hub.docker.com/settings/security"
            exit 1
          fi
          echo "âœ… Docker Hub secrets validated"
          echo "Username: ${{ secrets.DOCKER_HUB_USERNAME }}"
          echo "Token: [HIDDEN]"

      # BÆ°á»›c 4: Setup Docker Buildx trÃªn mÃ¡y áº£o GitHub
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      # BÆ°á»›c 5: ÄÄƒng nháº­p Docker Hub (Ä‘á»ƒ push image)
      - name: Login to Docker Hub
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKER_HUB_USERNAME }}
          password: ${{ secrets.DOCKER_HUB_TOKEN }}
          logout: false

      # BÆ°á»›c 6: Build Docker image trÃªn mÃ¡y áº£o GitHub vÃ  push lÃªn Docker Hub
      # - Build image tá»« Dockerfile vá»›i ENV_FILE=prod
      # - Tag image vá»›i tÃªn repository
      # - Push image lÃªn Docker Hub (chá»‰ khi push vÃ o staging branch Ä‘á»ƒ deploy)
      # - Cache layers Ä‘á»ƒ build nhanh hÆ¡n láº§n sau
      - name: Build and push Docker image
        uses: docker/build-push-action@v5
        with:
          context: .                                    # Build context: root cá»§a fe_ecommerce_ebay repo
          file: ./environment/Dockerfile                 # Dockerfile path
          # Chá»‰ push image khi push vÃ o branch staging (deploy branch)
          push: ${{ github.event_name == 'push' && github.ref == 'refs/heads/staging' }}
          tags: |
            ${{ env.DOCKER_HUB_USER }}/${{ env.DOCKER_HUB_REPO }}:frontend-latest
            ${{ env.DOCKER_HUB_USER }}/${{ env.DOCKER_HUB_REPO }}:frontend-${{ github.sha }}
          build-args: |
            ENV_FILE=prod
          cache-from: type=gha                          # DÃ¹ng cache tá»« GitHub Actions
          cache-to: type=gha,mode=max                    # LÆ°u cache Ä‘á»ƒ láº§n sau build nhanh hÆ¡n
          platforms: linux/amd64                        # Build cho platform Linux AMD64

      - name: Success message (Image pushed)
        if: github.event_name == 'push'
        run: |
          echo "âœ… Image built successfully!"
          # Branch dÃ¹ng Ä‘á»ƒ deploy (Ä‘Æ°á»£c push image + SSH deploy)
          DEPLOY_BRANCHES="staging"
          CURRENT_BRANCH="${{ github.ref_name }}"

          # Check if current branch is in DEPLOY_BRANCHES (comma-separated)
          if echo "$DEPLOY_BRANCHES" | tr ',' '\n' | grep -qx "$CURRENT_BRANCH"; then
            echo "âœ… Image pushed to Docker Hub!"
            echo "Branch: $CURRENT_BRANCH"
            echo "Tags:"
            echo "  - ${{ env.DOCKER_HUB_USER }}/${{ env.DOCKER_HUB_REPO }}:frontend-latest"
            echo "  - ${{ env.DOCKER_HUB_USER }}/${{ env.DOCKER_HUB_REPO }}:frontend-${{ github.sha }}"
          else
            echo "â„¹ï¸  Image built but not pushed ($CURRENT_BRANCH branch - build only)"
          fi

      # BÆ°á»›c 7: Copy docker-compose.prod.yml vÃ  nginx config lÃªn server
      # Tá»± Ä‘á»™ng copy cÃ¡c file cáº§n thiáº¿t Ä‘á»ƒ Ä‘áº£m báº£o luÃ´n cÃ³ file má»›i nháº¥t trÃªn server
      - name: Copy docker-compose to server
        # Chá»‰ deploy khi push vÃ o staging (main chá»‰ build)
        if: github.event_name == 'push' && github.ref == 'refs/heads/staging'
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: '22'
          source: "environment/compose/docker-compose.prod.yml"
          target: "/tmp"
          strip_components: 0

      # Copy nginx config files (cáº§n thiáº¿t cho nginx reverse proxy)
      - name: Copy nginx config to server
        if: github.event_name == 'push' && github.ref == 'refs/heads/staging'
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: '22'
          source: "environment/nginx"
          target: "/tmp"
          strip_components: 0

      # Táº¡o .htpasswd file trÃªn server (HTTP Basic Authentication)
      # âš ï¸ LÆ¯U Ã: File .htpasswd sáº½ Ä‘Æ°á»£c táº¡o trÃªn server tá»« GitHub Secrets
      # Format: username:hashed_password (cÃ³ thá»ƒ táº¡o tá»« htpasswd hoáº·c online tool)
      - name: Create .htpasswd on server
        if: github.event_name == 'push' && github.ref == 'refs/heads/staging'
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: '22'
          script: |
            # Táº¡o thÆ° má»¥c nginx náº¿u chÆ°a cÃ³
            DEPLOY_PATH="${{ secrets.SSH_DEPLOY_PATH }}"
            if [ -z "$DEPLOY_PATH" ]; then
              DEPLOY_PATH="$HOME/ebay_ecommerce/fe_ecommerce_ebay/environment"
            fi
            DEPLOY_PATH="${DEPLOY_PATH/#\~/$HOME}"
            mkdir -p "${DEPLOY_PATH}/nginx" || true
            
            # Táº¡o file .htpasswd tá»« secret hoáº·c dÃ¹ng giÃ¡ trá»‹ máº·c Ä‘á»‹nh
            # Format: username:$apr1$salt$hashedpassword
            # âš ï¸ LÆ¯U Ã: DÃ¹ng base64 encode trong secret Ä‘á»ƒ trÃ¡nh bash expand $variables
            # Secret pháº£i lÃ  base64 encoded cá»§a htpasswd content
            HTPASSWD_B64="${{ secrets.HTPASSWD_CONTENT }}"
            if [ -z "$HTPASSWD_B64" ] || [ "$HTPASSWD_B64" = "" ]; then
              # DÃ¹ng giÃ¡ trá»‹ máº·c Ä‘á»‹nh (admin:admin123) - base64 encoded
              echo "âš ï¸ Warning: HTPASSWD_CONTENT secret not set, using default"
              echo 'YWRtaW46JGFwcjEkNGtKdHBTZTUkZTVGUW5DQ2daS0g3TDhaQTdCSU1HMAo=' | base64 -d > "${DEPLOY_PATH}/nginx/.htpasswd"
            else
              # Decode base64 tá»« secret
              echo "$HTPASSWD_B64" | base64 -d > "${DEPLOY_PATH}/nginx/.htpasswd"
              echo "âœ… Decoded .htpasswd from base64 secret"
            fi
            
            # Set permissions
            chmod 644 "${DEPLOY_PATH}/nginx/.htpasswd" || true
            echo "âœ… Created .htpasswd file at ${DEPLOY_PATH}/nginx/.htpasswd"

      # BÆ°á»›c 8: Deploy lÃªn server qua SSH
      # - SSH vÃ o server báº±ng password
      # - Pull image má»›i tá»« Docker Hub
      # - Restart containers vá»›i docker-compose
      - name: Deploy to Server via SSH
        if: github.event_name == 'push' && github.ref == 'refs/heads/staging'
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: '22'
          script: |
            echo "ğŸš€ Starting deployment..."
            
            # XÃ¡c Ä‘á»‹nh deploy path tá»« secret hoáº·c default
            DEPLOY_PATH="${{ secrets.SSH_DEPLOY_PATH }}"
            if [ -z "$DEPLOY_PATH" ]; then
              DEPLOY_PATH="$HOME/ebay_ecommerce/fe_ecommerce_ebay/environment"
            fi
            # Expand ~ to $HOME if present
            DEPLOY_PATH="${DEPLOY_PATH/#\~/$HOME}"
            echo "ğŸ“ Deploy path: ${DEPLOY_PATH}"
            
            # Tá»± Ä‘á»™ng táº¡o thÆ° má»¥c náº¿u chÆ°a tá»“n táº¡i
            echo "ğŸ“‚ Creating directory structure if not exists..."
            mkdir -p "${DEPLOY_PATH}/compose" || {
              echo "âŒ Error: Failed to create directory: ${DEPLOY_PATH}/compose"
              echo "Current user: $(whoami)"
              echo "Home directory: $HOME"
              exit 1
            }
            mkdir -p "${DEPLOY_PATH}/nginx/conf.d" || {
              echo "âŒ Error: Failed to create nginx directory"
              exit 1
            }
            
            # Táº¡o thÆ° má»¥c certbot (cáº§n cho SSL Let's Encrypt)
            # Náº¿u Ä‘Ã£ tá»“n táº¡i thÃ¬ khÃ´ng bÃ¡o lá»—i, chá»‰ táº¡o náº¿u chÆ°a cÃ³
            echo "ğŸ“ Setting up certbot directories..."
            if [ -d "/root/certbot/conf" ]; then
              echo "â„¹ï¸  /root/certbot/conf already exists"
            else
              mkdir -p /root/certbot/conf && echo "âœ… Created /root/certbot/conf" || echo "âš ï¸ Warning: Failed to create /root/certbot/conf"
            fi
            
            if [ -d "/root/certbot/www" ]; then
              echo "â„¹ï¸  /root/certbot/www already exists"
            else
              mkdir -p /root/certbot/www && echo "âœ… Created /root/certbot/www" || echo "âš ï¸ Warning: Failed to create /root/certbot/www"
            fi
            
            # Set permissions (khÃ´ng bÃ¡o lá»—i náº¿u Ä‘Ã£ Ä‘Ãºng)
            chmod 755 /root/certbot/conf 2>/dev/null || true
            chmod 755 /root/certbot/www 2>/dev/null || true
            echo "âœ… Certbot directories ready"
            echo "âœ… Directory structure created/verified"
            
            # Copy docker-compose.prod.yml tá»« /tmp vÃ o Ä‘Ãºng vá»‹ trÃ­
            echo "ğŸ“‹ Copying docker-compose.prod.yml to deployment directory..."
            # scp-action vá»›i strip_components: 0 sáº½ giá»¯ nguyÃªn cáº¥u trÃºc thÆ° má»¥c
            # File sáº½ á»Ÿ: /tmp/environment/compose/docker-compose.prod.yml
            if [ -f "/tmp/environment/compose/docker-compose.prod.yml" ]; then
              cp /tmp/environment/compose/docker-compose.prod.yml "${DEPLOY_PATH}/compose/docker-compose.prod.yml" || {
                echo "âŒ Error: Failed to copy docker-compose.prod.yml"
                exit 1
              }
              echo "âœ… docker-compose.prod.yml copied successfully"
            elif [ -f "/tmp/docker-compose.prod.yml" ]; then
              # Fallback: náº¿u file á»Ÿ /tmp trá»±c tiáº¿p
              cp /tmp/docker-compose.prod.yml "${DEPLOY_PATH}/compose/docker-compose.prod.yml" || {
                echo "âŒ Error: Failed to copy docker-compose.prod.yml"
                exit 1
              }
              echo "âœ… docker-compose.prod.yml copied successfully"
            else
              echo "âš ï¸ Warning: docker-compose.prod.yml not found in /tmp, checking if it exists in deployment path..."
            fi
            
            # Copy nginx config files tá»« /tmp vÃ o Ä‘Ãºng vá»‹ trÃ­
            echo "ğŸ“‹ Copying nginx config files to deployment directory..."
            if [ -d "/tmp/environment/nginx" ]; then
              # Chá»‰ copy config files, khÃ´ng copy .htpasswd (Ä‘Ã£ Ä‘Æ°á»£c táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c)
              cp -r /tmp/environment/nginx/conf.d "${DEPLOY_PATH}/nginx/" 2>/dev/null || true
              cp /tmp/environment/nginx/nginx.conf "${DEPLOY_PATH}/nginx/nginx.conf" 2>/dev/null || true
              echo "âœ… nginx config files copied successfully"
            elif [ -d "/tmp/nginx" ]; then
              # Fallback: náº¿u nginx á»Ÿ /tmp trá»±c tiáº¿p
              cp -r /tmp/nginx/conf.d "${DEPLOY_PATH}/nginx/" 2>/dev/null || true
              cp /tmp/nginx/nginx.conf "${DEPLOY_PATH}/nginx/nginx.conf" 2>/dev/null || true
              echo "âœ… nginx config files copied successfully"
            else
              echo "âš ï¸ Warning: nginx config files not found in /tmp"
            fi
            
            # Kiá»ƒm tra file .htpasswd Ä‘Ã£ Ä‘Æ°á»£c táº¡o chÆ°a
            if [ -f "${DEPLOY_PATH}/nginx/.htpasswd" ]; then
              echo "âœ… .htpasswd file exists at ${DEPLOY_PATH}/nginx/.htpasswd"
            else
              echo "âš ï¸ Warning: .htpasswd file not found"
              echo "ğŸ’¡ Tip: File should have been created in previous step from HTPASSWD_CONTENT secret"
            fi
            
            # Cleanup temp files
            rm -rf /tmp/environment /tmp/nginx || true
            
            # Äiá»u hÆ°á»›ng Ä‘áº¿n thÆ° má»¥c project
            cd "${DEPLOY_PATH}" || {
              echo "âŒ Error: Deploy path not found: ${DEPLOY_PATH}"
              echo "Please check SSH_DEPLOY_PATH secret/variable or ensure path exists on server"
              echo "Current user: $(whoami)"
              echo "Home directory: $HOME"
              exit 1
            }
            
            # Kiá»ƒm tra docker-compose file cÃ³ tá»“n táº¡i khÃ´ng
            if [ ! -f "compose/docker-compose.prod.yml" ]; then
              echo "âŒ Error: docker-compose.prod.yml not found!"
              echo "Expected path: ${DEPLOY_PATH}/compose/docker-compose.prod.yml"
              echo "Current directory: $(pwd)"
              echo "Files in current directory:"
              ls -la || true
              echo "Files in compose directory:"
              ls -la compose/ || true
              exit 1
            fi
            echo "âœ… Found docker-compose.prod.yml"
            
            # Login Docker Hub (náº¿u cáº§n)
            echo "ğŸ” Logging into Docker Hub..."
            echo "${{ secrets.DOCKER_HUB_TOKEN }}" | docker login -u "${{ secrets.DOCKER_HUB_USERNAME }}" --password-stdin || {
              echo "âš ï¸ Warning: Docker login failed, trying without login..."
            }
            
            # Pull image má»›i tá»« Docker Hub
            echo "ğŸ“¥ Pulling latest image..."
            docker pull ${{ env.DOCKER_HUB_USER }}/${{ env.DOCKER_HUB_REPO }}:frontend-latest || {
              echo "âŒ Error: Failed to pull image!"
              exit 1
            }
            
            # Táº¡o Docker network náº¿u chÆ°a cÃ³ (cáº§n cho containers)
            echo "ğŸŒ Setting up Docker network..."
            if docker network inspect ebay-network >/dev/null 2>&1; then
              echo "â„¹ï¸  Network ebay-network already exists"
            else
              docker network create ebay-network && echo "âœ… Created network ebay-network" || {
                echo "âš ï¸ Warning: Failed to create network ebay-network"
                echo "ğŸ’¡ Tip: Network might already exist or Docker daemon issue"
              }
            fi

            # Pull táº¥t cáº£ images tá»« docker-compose (nginx + frontend)
            echo "ğŸ“¥ Pulling all images from docker-compose..."
            docker compose -f compose/docker-compose.prod.yml pull || {
              echo "âš ï¸ Warning: Some images failed to pull, continuing..."
            }
            
            # Restart containers vá»›i docker-compose
            echo "ğŸ”„ Starting/restarting containers..."
            # Start cÃ¡c services: nextjs-frontend, nginx
            docker compose -f compose/docker-compose.prod.yml up -d --force-recreate nextjs-frontend nginx || {
              echo "âŒ Error: Failed to start containers!"
              echo "ğŸ’¡ Checking docker-compose file..."
              docker compose -f compose/docker-compose.prod.yml config || true
              exit 1
            }
            
            # Kiá»ƒm tra health
            echo "ğŸ¥ Checking container health..."
            sleep 10
            docker compose -f compose/docker-compose.prod.yml ps
            
            # Cleanup old images (tÃ¹y chá»n)
            echo "ğŸ§¹ Cleaning up old images..."
            docker image prune -f || true
            
            echo "âœ… Deployment completed successfully!"
            echo ""
            echo "ğŸ“ Next Steps:"
            echo "   - Nginx vÃ  Frontend Ä‘Ã£ Ä‘Æ°á»£c deploy"
            echo "   - Äá»ƒ setup SSL Let's Encrypt, cháº¡y trÃªn server:"
            echo "     docker run --rm -it -v /root/certbot/conf:/etc/letsencrypt -v /root/certbot/www:/var/www/certbot certbot/certbot certonly --webroot --webroot-path=/var/www/certbot -d calatha.com -d www.calatha.com -d api.calatha.com -m your-email@example.com --agree-tos --no-eff-email"
            echo "   - Sau Ä‘Ã³ reload nginx: docker exec ebay_ecommerce-nginx-prod nginx -s reload"
            echo "   - Certbot auto-renewal Ä‘Ã£ Ä‘Æ°á»£c enable (runs every 12 hours)"

      - name: Build completed summary
        if: always()
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ“Š BUILD SUMMARY"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "Event: ${{ github.event_name }}"
          echo "Branch: ${{ github.ref }} (name: ${{ github.ref_name }})"
          echo "Commit: ${{ github.sha }}"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          if [ "${{ github.event_name }}" == "pull_request" ]; then
            echo "âœ… Build completed successfully (PR - no push)"
          elif [ "${{ github.ref_name }}" = "staging" ]; then
            echo "âœ… Build and deployment completed successfully! (deploy branch: staging)"
          elif [ "${{ github.ref_name }}" = "main" ]; then
            echo "âœ… Build completed successfully (main branch - build only, no deploy)"
          else
            echo "âœ… Build completed successfully (${{ github.ref_name }} branch)"
          fi
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

